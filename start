#!/bin/bash
#
# Start mm2
#
# @author webworker01
#
scriptpath="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null 2>&1 && pwd )"
source $scriptpath/main

cd ${scriptpath}/coins
git pull
cp ${scriptpath}/coins/coins "${mmpath}coins"

export userpass=${userpass}

cat <<EOF > ${mmpath}/MM2.json
{
    "gui": "mmtools",
    "netid": ${netid},
    "rpc_password": "${userpass}",
    "passphrase": "${passphrase}",
    "userhome": "/${HOME#\"/\"}"
}
EOF

cd ${mmpath}
./mm2 update_config ${mmpath}coins ${mmpath}coins &
./mm2 &

sleep 7

if (( automation > 0 )); then
    for enable_coin in ${auto_electrum[@]}; do
        $scriptpath/electrum $enable_coin
    done

    $scriptpath/coins_needed_for_kick_start
fi

if (( enablempm > 0 )); then
    cd ${scriptpath}
    cd cipimmtools
    git pull
fi